<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>extraChIPs: Range-based operations • extraChIPs</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="extraChIPs: Range-based operations">
<meta property="og:description" content="extraChIPs">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">extraChIPs</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.17</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/range_based_functions.html">Range-based Operations</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/steveped/extraChIPs/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>extraChIPs: Range-based operations</h1>
                        <h4 data-toc-skip class="author">Steve Pederson</h4>
            <address class="author_afil">
      Dame Roma Mitchell Cancer Research Laboratories, Adelaide Medical School, University of Adelaide<br><a class="author_email" href="mailto:#"></a><a href="mailto:stephen.pederson.au@gmail.com" class="email">stephen.pederson.au@gmail.com</a>
      </address>
                  
      
      <small class="dont-index">Source: <a href="https://github.com/steveped/extraChIPs/blob/HEAD/vignettes/range_based_functions.Rmd" class="external-link"><code>vignettes/range_based_functions.Rmd</code></a></small>
      <div class="hidden name"><code>range_based_functions.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This package is designed to enable the Gene Regulatory Analysis using Variable IP (<a href="https://github.com/steveped/GRAVI" class="external-link">GRAVI</a>) workflow, as a method for detecting differential binding in ChIP-Seq datasets. As a workflow focussed on data integration, most functions provided by the package <code>extraChIPs</code> are designed to enable comparison across datasets. This vignette looks primarily at functions which work with <code>GenomicRanges</code> objects</p>
</div>
<div class="section level2">
<h2 id="coercion">Coercion<a class="anchor" aria-label="anchor" href="#coercion"></a>
</h2>
<p>The advent of the <code>tidyverse</code> has led to <code>tibble</code> objects becoming a common alternative to <code>data.frame</code> or <code>DataFrame</code> objects. Simple functions within <code>extraChIP</code> enable coercion from <code>GRanges</code>, <code>GInteractions</code> and <code>DataFrame</code> objects to tibble objects, with list columns correctly handled. By default these coercion functions will coerce <code>GRanges</code> elements to a character vector. Similarly, <code>GRanges</code> represented as a character column can be coerced to the ranges element of a <code>GRanges</code> object.</p>
<p>First let’s coerce from a <code>tibble</code> (or S3 <code>data.frame</code>) to a <code>GRanges</code></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/steveped/extraChIPs" class="external-link">extraChIPs</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">73</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>
  range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1:1-10:+"</span>, <span class="st">"chr1:5-10:+"</span>, <span class="st">"chr1:5-6:+"</span><span class="op">)</span>,
  gene_id <span class="op">=</span> <span class="st">"gene1"</span>,
  tx_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"transcript"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,
  score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">df</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 3 × 4</span></span>
<span class="co">##   range       gene_id tx_id        score</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> chr1:1-10:+ gene1   transcript1 0.442 </span>
<span class="co">## <span style="color: #BCBCBC;">2</span> chr1:5-10:+ gene1   transcript2 0.083<span style="text-decoration: underline;">1</span></span>
<span class="co">## <span style="color: #BCBCBC;">3</span> chr1:5-6:+  gene1   transcript3 0.615</span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/colToRanges-methods.html">colToRanges</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"range"</span><span class="op">)</span>
<span class="va">gr</span></code></pre></div>
<pre><code><span class="co">## GRanges object with 3 ranges and 3 metadata columns:</span>
<span class="co">##       seqnames    ranges strand |     gene_id       tx_id     score</span>
<span class="co">##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;character&gt; &lt;numeric&gt;</span>
<span class="co">##   [1]     chr1      1-10      + |       gene1 transcript1 0.4423369</span>
<span class="co">##   [2]     chr1      5-10      + |       gene1 transcript2 0.0831099</span>
<span class="co">##   [3]     chr1       5-6      + |       gene1 transcript3 0.6146112</span>
<span class="co">##   -------</span>
<span class="co">##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></code></pre>
<p>Coercion back to a <code>tibble</code> will place the ranges as a character column by default. However, this can be turned off and the conventional coercion from <code>as.data.frame</code> will instead be applied, internally wrapped in <code><a href="../reference/as_tibble.html">as_tibble()</a></code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">gr</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 3 × 4</span></span>
<span class="co">##   range       gene_id tx_id        score</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> chr1:1-10:+ gene1   transcript1 0.442 </span>
<span class="co">## <span style="color: #BCBCBC;">2</span> chr1:5-10:+ gene1   transcript2 0.083<span style="text-decoration: underline;">1</span></span>
<span class="co">## <span style="color: #BCBCBC;">3</span> chr1:5-6:+  gene1   transcript3 0.615</span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">gr</span>, rangeAsChar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 3 × 8</span></span>
<span class="co">##   seqnames start   end width strand gene_id tx_id        score</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> chr1         1    10    10 +      gene1   transcript1 0.442 </span>
<span class="co">## <span style="color: #BCBCBC;">2</span> chr1         5    10     6 +      gene1   transcript2 0.083<span style="text-decoration: underline;">1</span></span>
<span class="co">## <span style="color: #BCBCBC;">3</span> chr1         5     6     2 +      gene1   transcript3 0.615</span></code></pre>
<p>A simple feature which may be useful for printing gene names using <code>rmarkdown</code> is contained in <code><a href="../reference/collapseGenes.html">collapseGenes()</a></code>. Here a character vector of gene names is collapsed into a <code>glue</code> object of length `, with gene names rendered in italics by default.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gene1"</span>, <span class="st">"Gene2"</span>, <span class="st">"Gene3"</span><span class="op">)</span>
<span class="fu"><a href="../reference/collapseGenes.html">collapseGenes</a></span><span class="op">(</span><span class="va">gn</span><span class="op">)</span></code></pre></div>
<p><em>Gene1</em>, <em>Gene2</em> and <em>Gene3</em></p>
</div>
<div class="section level2">
<h2 id="simple-operations-retaining-mcols">Simple Operations Retaining <code>mcols()</code><a class="anchor" aria-label="anchor" href="#simple-operations-retaining-mcols"></a>
</h2>
<p>The standard set operations implemented in the package <code>GenomicRanges</code> will always drop the <code>mcols</code> element by default. The <code>extraChIPs</code> functions <code><a href="../reference/reduceMC-methods.html">reduceMC()</a></code>, <code><a href="../reference/setoptsMC-methods.html">setdiffMC()</a></code>, <code><a href="../reference/setoptsMC-methods.html">intersectMC()</a></code> and <code><a href="../reference/setoptsMC-methods.html">unionMC()</a></code> all produce the same output as their similarly-named functions, however, the <code>mcols()</code> elements in the query object are also returned. Where required, columns are coerced into <code>CompressedList</code> columns. This can particularly useful when needed to propagate the information contained in the initial ranges through to subsequent analytic steps</p>
<div class="section level3">
<h3 id="simplifying-single-granges-objects">Simplifying single <code>GRanges</code> objects<a class="anchor" aria-label="anchor" href="#simplifying-single-granges-objects"></a>
</h3>
<p>The classical approach to defining TSS regions for a set of transcripts would be to use the function <code>resize</code>()`, setting the width as 1.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/intra-range-methods.html" class="external-link">resize</a></span><span class="op">(</span><span class="va">gr</span>, width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">tss</span></code></pre></div>
<pre><code><span class="co">## GRanges object with 3 ranges and 3 metadata columns:</span>
<span class="co">##       seqnames    ranges strand |     gene_id       tx_id     score</span>
<span class="co">##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;character&gt; &lt;numeric&gt;</span>
<span class="co">##   [1]     chr1         1      + |       gene1 transcript1 0.4423369</span>
<span class="co">##   [2]     chr1         5      + |       gene1 transcript2 0.0831099</span>
<span class="co">##   [3]     chr1         5      + |       gene1 transcript3 0.6146112</span>
<span class="co">##   -------</span>
<span class="co">##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></code></pre>
<p>As we can see, two transcripts start at position 5, so we may choose to reduce this, which would lose the <code>mcols</code> element. The alternative <code><a href="../reference/reduceMC-methods.html">reduceMC()</a></code> will retain all <code>mcols</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">GenomicRanges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/inter-range-methods.html" class="external-link">reduce</a></span><span class="op">(</span><span class="va">tss</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## GRanges object with 2 ranges and 0 metadata columns:</span>
<span class="co">##       seqnames    ranges strand</span>
<span class="co">##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;</span>
<span class="co">##   [1]     chr1         1      +</span>
<span class="co">##   [2]     chr1         5      +</span>
<span class="co">##   -------</span>
<span class="co">##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/reduceMC-methods.html">reduceMC</a></span><span class="op">(</span><span class="va">tss</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## GRanges object with 2 ranges and 3 metadata columns:</span>
<span class="co">##       seqnames    ranges strand |     gene_id                   tx_id</span>
<span class="co">##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;         &lt;CharacterList&gt;</span>
<span class="co">##   [1]     chr1         1      + |       gene1             transcript1</span>
<span class="co">##   [2]     chr1         5      + |       gene1 transcript2,transcript3</span>
<span class="co">##                     score</span>
<span class="co">##             &lt;NumericList&gt;</span>
<span class="co">##   [1]            0.442337</span>
<span class="co">##   [2] 0.0831099,0.6146112</span>
<span class="co">##   -------</span>
<span class="co">##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></code></pre>
<p>By default, this function will attempt to coerce <code>mcols</code> to a new <code>mcol</code> of the appropriate type, however, when multiple values are inevitable such as for the <code>tx_id</code> column above, these will be coerced to a <code>CompressedList</code>. The simplification of the multiple values seen in the <code>gene_id</code> can also be turned off if desired should repeated values be important for downstream analysis.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/reduceMC-methods.html">reduceMC</a></span><span class="op">(</span><span class="va">tss</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </code></pre></div>
<pre><code><span class="co">## GRanges object with 2 ranges and 3 metadata columns:</span>
<span class="co">##       seqnames    ranges strand |         gene_id                   tx_id</span>
<span class="co">##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;CharacterList&gt;         &lt;CharacterList&gt;</span>
<span class="co">##   [1]     chr1         1      + |           gene1             transcript1</span>
<span class="co">##   [2]     chr1         5      + |     gene1,gene1 transcript2,transcript3</span>
<span class="co">##                     score</span>
<span class="co">##             &lt;NumericList&gt;</span>
<span class="co">##   [1]            0.442337</span>
<span class="co">##   [2] 0.0831099,0.6146112</span>
<span class="co">##   -------</span>
<span class="co">##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></code></pre>
<p>This allows for simple integration with <code>tidyverse</code> nesting strategies.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/reduceMC-methods.html">reduceMC</a></span><span class="op">(</span><span class="va">tss</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 3 × 4</span></span>
<span class="co">##   range    gene_id tx_id        score</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> chr1:1:+ gene1   transcript1 0.442 </span>
<span class="co">## <span style="color: #BCBCBC;">2</span> chr1:5:+ gene1   transcript2 0.083<span style="text-decoration: underline;">1</span></span>
<span class="co">## <span style="color: #BCBCBC;">3</span> chr1:5:+ gene1   transcript3 0.615</span></code></pre>
<p>Whilst <code>reduceMC</code> relies on the range-reduction as implemented in <code><a href="https://rdrr.io/pkg/GenomicRanges/man/inter-range-methods.html" class="external-link">GenomicRanges::reduce()</a></code>, some alternative approaches are included, such as <code><a href="../reference/chopRanges-methods.html">chopRanges()</a></code>, which finds identical ranges and nests the mcols element as <code>CompressedList</code> objects.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/chopRanges-methods.html">chopRanges</a></span><span class="op">(</span><span class="va">tss</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## GRanges object with 2 ranges and 3 metadata columns:</span>
<span class="co">##       seqnames    ranges strand |     gene_id                   tx_id</span>
<span class="co">##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;         &lt;CharacterList&gt;</span>
<span class="co">##   [1]     chr1         1      + |       gene1             transcript1</span>
<span class="co">##   [2]     chr1         5      + |       gene1 transcript2,transcript3</span>
<span class="co">##                     score</span>
<span class="co">##             &lt;NumericList&gt;</span>
<span class="co">##   [1]            0.442337</span>
<span class="co">##   [2] 0.0831099,0.6146112</span>
<span class="co">##   -------</span>
<span class="co">##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></code></pre>
<p>In the case of the object <code>tss</code>, this output is identical to <code><a href="../reference/reduceMC-methods.html">reduceMC()</a></code>, however, given that there are no identical ranges in <code>gr</code> the two functions would behave very differently on that object.</p>
<p>A final operation for simplifying <code>GRanges</code> objects would be <code><a href="../reference/distinctRanges-methods.html">distinctRanges()</a></code> which finds unique ranges, along with unique <code>mcols</code>. The columns to search can be called using <code>&lt;tidy-select&gt;</code> approaches,</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/distinctRanges-methods.html">distinctRanges</a></span><span class="op">(</span><span class="va">tss</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## GRanges object with 3 ranges and 3 metadata columns:</span>
<span class="co">##       seqnames    ranges strand |     gene_id       tx_id     score</span>
<span class="co">##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;character&gt; &lt;numeric&gt;</span>
<span class="co">##   [1]     chr1         1      + |       gene1 transcript1 0.4423369</span>
<span class="co">##   [2]     chr1         5      + |       gene1 transcript2 0.0831099</span>
<span class="co">##   [3]     chr1         5      + |       gene1 transcript3 0.6146112</span>
<span class="co">##   -------</span>
<span class="co">##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/distinctRanges-methods.html">distinctRanges</a></span><span class="op">(</span><span class="va">tss</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="st">"gene_id"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## GRanges object with 2 ranges and 1 metadata column:</span>
<span class="co">##       seqnames    ranges strand |     gene_id</span>
<span class="co">##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;</span>
<span class="co">##   [1]     chr1         1      + |       gene1</span>
<span class="co">##   [2]     chr1         5      + |       gene1</span>
<span class="co">##   -------</span>
<span class="co">##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></code></pre>
</div>
<div class="section level3">
<h3 id="set-operations-with-two-granges-objects">Set Operations with Two <code>GRanges</code> Objects<a class="anchor" aria-label="anchor" href="#set-operations-with-two-granges-objects"></a>
</h3>
<p>Whilst <code>reduce/reduceMC</code> is applied to a single <code>GRanges</code> object, the set operation functions <code>intersect</code>, <code>setdiff</code> and <code>union</code> are valuable approaches for comparing ranges. Using the <code>*MC()</code> functions will retain <code>mcols</code> elements from the <em>query range</em>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">peaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="st">"chr1:9-12:*"</span><span class="op">)</span>
<span class="va">peaks</span><span class="op">$</span><span class="va">peak_id</span> <span class="op">&lt;-</span> <span class="st">"peak1"</span>
<span class="fu">GenomicRanges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/setops-methods.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">gr</span>, <span class="va">peaks</span>, ignore.strand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## GRanges object with 1 range and 0 metadata columns:</span>
<span class="co">##       seqnames    ranges strand</span>
<span class="co">##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;</span>
<span class="co">##   [1]     chr1      9-10      *</span>
<span class="co">##   -------</span>
<span class="co">##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/setoptsMC-methods.html">intersectMC</a></span><span class="op">(</span><span class="va">gr</span>, <span class="va">peaks</span>, ignore.strand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## GRanges object with 1 range and 3 metadata columns:</span>
<span class="co">##       seqnames    ranges strand |     gene_id                   tx_id</span>
<span class="co">##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;         &lt;CharacterList&gt;</span>
<span class="co">##   [1]     chr1      9-10      * |       gene1 transcript1,transcript2</span>
<span class="co">##                     score</span>
<span class="co">##             &lt;NumericList&gt;</span>
<span class="co">##   [1] 0.4423369,0.0831099</span>
<span class="co">##   -------</span>
<span class="co">##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/setoptsMC-methods.html">setdiffMC</a></span><span class="op">(</span><span class="va">gr</span>, <span class="va">peaks</span>, ignore.strand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## GRanges object with 1 range and 3 metadata columns:</span>
<span class="co">##       seqnames    ranges strand |     gene_id</span>
<span class="co">##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;</span>
<span class="co">##   [1]     chr1       1-8      * |       gene1</span>
<span class="co">##                                     tx_id                         score</span>
<span class="co">##                           &lt;CharacterList&gt;                 &lt;NumericList&gt;</span>
<span class="co">##   [1] transcript1,transcript2,transcript3 0.4423369,0.0831099,0.6146112</span>
<span class="co">##   -------</span>
<span class="co">##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/setoptsMC-methods.html">unionMC</a></span><span class="op">(</span><span class="va">gr</span>, <span class="va">peaks</span>, ignore.strand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## GRanges object with 1 range and 3 metadata columns:</span>
<span class="co">##       seqnames    ranges strand |     gene_id</span>
<span class="co">##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;</span>
<span class="co">##   [1]     chr1      1-12      * |       gene1</span>
<span class="co">##                                     tx_id                         score</span>
<span class="co">##                           &lt;CharacterList&gt;                 &lt;NumericList&gt;</span>
<span class="co">##   [1] transcript1,transcript2,transcript3 0.4423369,0.0831099,0.6146112</span>
<span class="co">##   -------</span>
<span class="co">##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></code></pre>
<p>There is a performance overhead to preparation of mcols as <code>CompressedList</code> objects and all <code>mcols</code> in the query object will be returned. If only wishing to retain a subset of <code>mcols</code>, these should be selected prior to passing to these functions.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">plyranges</span><span class="op">)</span>
<span class="va">gr</span> <span class="op"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html" class="external-link">select</a></span><span class="op">(</span><span class="va">tx_id</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/setoptsMC-methods.html">intersectMC</a></span><span class="op">(</span><span class="va">peaks</span>, ignore.strand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## GRanges object with 1 range and 1 metadata column:</span>
<span class="co">##       seqnames    ranges strand |                   tx_id</span>
<span class="co">##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; |         &lt;CharacterList&gt;</span>
<span class="co">##   [1]     chr1      9-10      * | transcript1,transcript2</span>
<span class="co">##   -------</span>
<span class="co">##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></code></pre>
</div>
<div class="section level3">
<h3 id="overlapping-proportions">Overlapping proportions<a class="anchor" aria-label="anchor" href="#overlapping-proportions"></a>
</h3>
<p>Whilst the functions <code><a href="https://rdrr.io/pkg/GenomicRanges/man/findOverlaps-methods.html" class="external-link">findOverlaps()</a></code> and <code><a href="https://rdrr.io/pkg/GenomicRanges/man/findOverlaps-methods.html" class="external-link">overlapsAny()</a></code> are extremely useful, the addition of <code><a href="../reference/overlapsProp-methods.html">overlapsProp()</a></code> returns a numeric vector with the proportion of each query range (<code>x</code>) which overlaps any range in the subject range (<code>y</code>)</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/overlapsProp-methods.html">overlapsProp</a></span><span class="op">(</span><span class="va">gr</span>, <span class="va">peaks</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.2000000 0.3333333 0.0000000</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="more-complex-operations">More Complex Operations<a class="anchor" aria-label="anchor" href="#more-complex-operations"></a>
</h2>
<div class="section level3">
<h3 id="range-paritioning">Range Paritioning<a class="anchor" aria-label="anchor" href="#range-paritioning"></a>
</h3>
<p>In addition to standard set operations, one set of ranges can be used to partition another set of ranges, returning <code>mcols</code> from both ranges. Ranges from the query range (<code>x</code>) are returned after being partitioned by the ranges in the subject range (<code>y</code>). Subject ranges used for partitioning <em>must be non-overlapping</em>, and if overlapping ranges are provided, these will be reduced prior to partitioning.</p>
<p>This enables the identification of specific ranges from the query range (<code>x</code>) which overlap ranges from the subject range (<code>y</code>) Under this approach, <code>mcols</code> from both <code>query</code> and <code>subject</code> ranges will be returned to enable the clear ranges which are common and distinct within the two sets of ranges.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/partitionRanges-methods.html">partitionRanges</a></span><span class="op">(</span><span class="va">gr</span>, <span class="va">peaks</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## GRanges object with 3 ranges and 4 metadata columns:</span>
<span class="co">##       seqnames    ranges strand |     gene_id                   tx_id</span>
<span class="co">##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;         &lt;CharacterList&gt;</span>
<span class="co">##   [1]     chr1       1-8      + |       gene1             transcript1</span>
<span class="co">##   [2]     chr1       5-8      + |       gene1             transcript2</span>
<span class="co">##   [3]     chr1      9-10      + |       gene1 transcript1,transcript2</span>
<span class="co">##                     score     peak_id</span>
<span class="co">##             &lt;NumericList&gt; &lt;character&gt;</span>
<span class="co">##   [1]            0.442337        &lt;NA&gt;</span>
<span class="co">##   [2]           0.0831099        &lt;NA&gt;</span>
<span class="co">##   [3] 0.4423369,0.0831099       peak1</span>
<span class="co">##   -------</span>
<span class="co">##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/partitionRanges-methods.html">partitionRanges</a></span><span class="op">(</span><span class="va">peaks</span>, <span class="va">gr</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## GRanges object with 2 ranges and 4 metadata columns:</span>
<span class="co">##       seqnames    ranges strand |     peak_id     gene_id</span>
<span class="co">##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;character&gt;</span>
<span class="co">##   [1]     chr1      9-10      + |       peak1       gene1</span>
<span class="co">##   [2]     chr1     11-12      + |       peak1        &lt;NA&gt;</span>
<span class="co">##                                     tx_id                         score</span>
<span class="co">##                           &lt;CharacterList&gt;                 &lt;NumericList&gt;</span>
<span class="co">##   [1] transcript1,transcript2,transcript3 0.4423369,0.0831099,0.6146112</span>
<span class="co">##   [2]                                                                  </span>
<span class="co">##   -------</span>
<span class="co">##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></code></pre>
<p>Whilst this shares some similarity with <code><a href="../reference/setoptsMC-methods.html">intersectMC()</a></code> the additional capabilities provide greater flexibility.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/partitionRanges-methods.html">partitionRanges</a></span><span class="op">(</span><span class="va">gr</span>, <span class="va">peaks</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">peak_id</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## GRanges object with 2 ranges and 4 metadata columns:</span>
<span class="co">##       seqnames    ranges strand |     gene_id           tx_id         score</span>
<span class="co">##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;CharacterList&gt; &lt;NumericList&gt;</span>
<span class="co">##   [1]     chr1       1-8      + |       gene1     transcript1      0.442337</span>
<span class="co">##   [2]     chr1       5-8      + |       gene1     transcript2     0.0831099</span>
<span class="co">##           peak_id</span>
<span class="co">##       &lt;character&gt;</span>
<span class="co">##   [1]        &lt;NA&gt;</span>
<span class="co">##   [2]        &lt;NA&gt;</span>
<span class="co">##   -------</span>
<span class="co">##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></code></pre>
</div>
<div class="section level3">
<h3 id="stitching-ranges">Stitching Ranges<a class="anchor" aria-label="anchor" href="#stitching-ranges"></a>
</h3>
<p>Using the function <code><a href="../reference/stitchRanges.html">stitchRanges()</a></code> we are able to join together sets of nearby ranges, but with the option of placing clear barriers between ranges, across which ranges cannot be joined. This may be useful if joining enhancers to form putative super-enhancers, but explicitly omitting defined promoter regions.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">enh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1:1-10"</span>, <span class="st">"chr1:101-110"</span>, <span class="st">"chr1:181-200"</span><span class="op">)</span><span class="op">)</span>
<span class="va">prom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="st">"chr1:150:+"</span><span class="op">)</span>
<span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stitchRanges.html">stitchRanges</a></span><span class="op">(</span><span class="va">enh</span>, exclude <span class="op">=</span> <span class="va">prom</span>, maxgap <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="va">se</span></code></pre></div>
<pre><code><span class="co">## GRanges object with 2 ranges and 0 metadata columns:</span>
<span class="co">##       seqnames    ranges strand</span>
<span class="co">##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;</span>
<span class="co">##   [1]     chr1     1-110      *</span>
<span class="co">##   [2]     chr1   181-200      *</span>
<span class="co">##   -------</span>
<span class="co">##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></code></pre>
<p>As a visualisation (below) ranges within 100bp were stitched together, however the region defined as a ‘promoter’ acted as a barrier and ranges were not stitched together across this barrier.</p>
<p><img src="range_based_functions_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="chip-seq-analysis">ChIP-Seq Analysis<a class="anchor" aria-label="anchor" href="#chip-seq-analysis"></a>
</h2>
<div class="section level3">
<h3 id="data-integration">Data Integration<a class="anchor" aria-label="anchor" href="#data-integration"></a>
</h3>
<p>The <a href="www.github.com/steveped/GRAVI">GRAVI</a> workflow which this package is designed for is based on sliding windows in a manner similar to the package <code>csaw</code>, but also incorporating <code>macs2</code> peaks. Analysis using <code>macs</code> commonly produces a set of files with identical structure as either <code>broadPeak</code> or <code>narrowPeak</code> format. Given their identical structure, these can easily be imported as single <code>GRangesList</code> object</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>
<span class="st">"extdata"</span>, <span class="st">"testFiles"</span>, <span class="st">"test.narrowPeak"</span>, package <span class="op">=</span> <span class="st">"extraChIPs"</span>
<span class="op">)</span>
<span class="va">grl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/importPeaks.html">importPeaks</a></span><span class="op">(</span><span class="va">fl</span>, <span class="st">"narrow"</span><span class="op">)</span></code></pre></div>
<p>For data integration, <code>GRangesList</code> objects can be coerced to <code>RangedSummarizedExperiment</code> objects. A set of consensus peaks is obtained across all samples by taking the union of overlapping regions. Representative values for each range are then selected by taking either the <code><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min()</a></code> or <code><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max()</a></code> value from a selected column within each range on a sample-specific basis.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grlToSE-methods.html">grlToSE</a></span><span class="op">(</span>
  <span class="va">grl</span>, 
  assayCols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pValue"</span>, <span class="st">"qValue"</span><span class="op">)</span>, 
  keyvals <span class="op">=</span> <span class="st">"qValue"</span>, by <span class="op">=</span> <span class="st">"max"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assays</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## List of length 2</span>
<span class="co">## names(2): pValue qValue</span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 2 1</span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">se</span>, <span class="st">"pValue"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      test.narrowPeak</span>
<span class="co">## [1,]         9.88778</span>
<span class="co">## [2,]        20.36137</span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/RangedSummarizedExperiment-class.html" class="external-link">rowRanges</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## GRanges object with 2 ranges and 0 metadata columns:</span>
<span class="co">##       seqnames          ranges strand</span>
<span class="co">##          &lt;Rle&gt;       &lt;IRanges&gt;  &lt;Rle&gt;</span>
<span class="co">##   [1]     chr1 1299656-1299826      *</span>
<span class="co">##   [2]     chr1 8031224-8031566      *</span>
<span class="co">##   -------</span>
<span class="co">##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>eval <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/Rsamtools" class="external-link">Rsamtools</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">csaw</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Bioconductor/BiocParallel" class="external-link">BiocParallel</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">rtracklayer</span><span class="op">)</span>
<span class="va">bfl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>
  <span class="st">"extdata"</span>, <span class="st">"bam"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ex1.bam"</span>, <span class="st">"input.bam"</span><span class="op">)</span>, package <span class="op">=</span> <span class="st">"extraChIPs"</span>
<span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/Rsamtools/man/BamFile-class.html" class="external-link">BamFileList</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bfl</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ex1"</span>, <span class="st">"input"</span><span class="op">)</span>
<span class="va">peaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rtracklayer/man/BEDFile-class.html" class="external-link">import.bed</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"peaks.bed.gz"</span>, package <span class="op">=</span> <span class="st">"extraChIPs"</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">peaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/genomic-range-squeezers.html" class="external-link">granges</a></span><span class="op">(</span><span class="va">peaks</span><span class="op">)</span>
<span class="va">rng</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="st">"chr10:103865501-103900700"</span><span class="op">)</span>
<span class="va">rp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/csaw/man/readParam.html" class="external-link">readParam</a></span><span class="op">(</span>
  pe <span class="op">=</span> <span class="st">"none"</span>,
  dedup <span class="op">=</span> <span class="cn">TRUE</span>,
  restrict <span class="op">=</span> <span class="st">"chr10"</span>
<span class="op">)</span>
<span class="va">wincounts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/csaw/man/windowCounts.html" class="external-link">windowCounts</a></span><span class="op">(</span>
  bam.files <span class="op">=</span> <span class="va">bfl</span>,
  spacing <span class="op">=</span> <span class="fl">180</span>,
  width <span class="op">=</span> <span class="fl">90</span>,
  ext <span class="op">=</span> <span class="fl">180</span>,
  filter <span class="op">=</span> <span class="fl">1</span>,
  param <span class="op">=</span> <span class="va">rp</span>,
  BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">wincounts</span><span class="op">$</span><span class="va">totals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">964076L</span>, <span class="fl">1172179L</span><span class="op">)</span>
<span class="va">filtcounts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dualFilter-methods.html">dualFilter</a></span><span class="op">(</span>
  <span class="va">wincounts</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,
  <span class="va">wincounts</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, 
  ref <span class="op">=</span> <span class="va">peaks</span>,
  q <span class="op">=</span> <span class="fl">0.5</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/RangedSummarizedExperiment-class.html" class="external-link">rowRanges</a></span><span class="op">(</span><span class="va">filtcounts</span><span class="op">)</span><span class="op">$</span><span class="va">logCPM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">filtcounts</span>,<span class="st">"logCPM"</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/RangedSummarizedExperiment-class.html" class="external-link">rowRanges</a></span><span class="op">(</span><span class="va">filtcounts</span><span class="op">)</span><span class="op">$</span><span class="va">logFC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">filtcounts</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/RangedSummarizedExperiment-class.html" class="external-link">rowRanges</a></span><span class="op">(</span><span class="va">filtcounts</span><span class="op">)</span><span class="op">$</span><span class="va">PValue</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">pchisq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/RangedSummarizedExperiment-class.html" class="external-link">rowRanges</a></span><span class="op">(</span><span class="va">filtcounts</span><span class="op">)</span><span class="op">$</span><span class="va">logFC</span><span class="op">^</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span>
<span class="va">res_gr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mergeByCol-methods.html">mergeByCol</a></span><span class="op">(</span><span class="va">filtcounts</span>, col <span class="op">=</span> <span class="st">"logCPM"</span>, pval <span class="op">=</span> <span class="st">"PValue"</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://github.com/steveped" class="external-link">Stephen Pederson</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
