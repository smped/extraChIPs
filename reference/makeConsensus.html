<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Make a set of consensus peaks — makeConsensus • extraChIPs</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Make a set of consensus peaks — makeConsensus"><meta property="og:description" content="Make a set of consensus peaks based on the number of replicates"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">extraChIPs</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/range_based_functions.html">Range-based Operations</a>
    </li>
    <li>
      <a href="../articles/differential_signal_sliding.html">Differential Signal Using Sliding Windows</a>
    </li>
    <li>
      <a href="../articles/differential_signal_fixed.html">Differential Signal Using Fixed-Width Windows</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/smped/extraChIPs" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Make a set of consensus peaks</h1>
    <small class="dont-index">Source: <a href="https://github.com/smped/extraChIPs/blob/HEAD/R/makeConsensus.R" class="external-link"><code>R/makeConsensus.R</code></a></small>
    <div class="hidden name"><code>makeConsensus.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Make a set of consensus peaks based on the number of replicates</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">makeConsensus</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"union"</span>, <span class="st">"coverage"</span><span class="op">)</span>,</span>
<span>  ignore.strand <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  simplify <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  min_width <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A GRangesList</p></dd>


<dt>p</dt>
<dd><p>The minimum proportion of samples (i.e. elements of <code>x</code>) required
for a peak to be retained in the output. By default all merged peaks will
be returned</p></dd>


<dt>var</dt>
<dd><p>Additional columns in the <code>mcols</code> element to retain</p></dd>


<dt>method</dt>
<dd><p>Either return the union of all overlapping ranges, or the
regions within the overlapping ranges which are covered by the specified
proportion of replicates. When using p = 0, both methods will return identical
results</p></dd>


<dt>ignore.strand, simplify, ...</dt>
<dd><p>Passed to <a href="reduceMC.html">reduceMC</a> or
<a href="setoptsMC-methods.html">intersectMC</a> internally</p></dd>


<dt>min_width</dt>
<dd><p>Discard any regions below this width</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>GRanges</code> object with mcols containing a logical vector for every element of
x, along with the column <code>n</code> which adds all logical columns. These columns
denote which replicates contain an overlapping peak for each range</p>


<p>If any additional columns have been requested using <code>var</code>, these will be
returned as CompressedList objects as produced by <code><a href="reduceMC.html">reduceMC()</a></code> or
<code><a href="setoptsMC-methods.html">intersectMC()</a></code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This takes a list of GRanges objects and forms a set of consensus peaks.</p>
<p>When using method = "union" the union ranges of all overlapping peaks will
be returned, using the minimum proportion of replicates specified.
When using method = "coverage", only the regions within each overlapping
range which are 'covered' by the minimum proportion of replicates specified
are returned. This will return narrower peaks in general, although some
artefactual very small ranges may be included (e.g. 10bp). Careful setting
of the min_width parameter may be very helpful for these instances. It is
also expected that setting method = "coverage" should return the region
within each range which is more likely to contain the true binding site for
the relevant ChIP targets</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="reduceMC.html">reduceMC</a> <a href="setoptsMC-methods.html">intersectMC</a></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"peaks"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## The first three replicates are from the same treatment group</span></span></span>
<span class="r-in"><span><span class="va">grl</span> <span class="op">&lt;-</span> <span class="va">peaks</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">grl</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"_peaks.+"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">grl</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">makeConsensus</span><span class="op">(</span><span class="va">grl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GRanges object with 244 ranges and 4 metadata columns:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         seqnames            ranges strand | SRR8315180 SRR8315181 SRR8315182</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt; |  &lt;logical&gt;  &lt;logical&gt;  &lt;logical&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [1]    chr10 43048195-43048529      * |       TRUE       TRUE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [2]    chr10 43521739-43522260      * |       TRUE       TRUE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [3]    chr10 43540042-43540390      * |       TRUE      FALSE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [4]    chr10 43606238-43606573      * |       TRUE       TRUE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [5]    chr10 43851214-43851989      * |      FALSE       TRUE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ...      ...               ...    ... .        ...        ...        ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [240]    chr10 99168353-99168649      * |       TRUE       TRUE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [241]    chr10 99207868-99208156      * |      FALSE       TRUE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [242]    chr10 99326100-99326363      * |      FALSE      FALSE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [243]    chr10 99331363-99331730      * |       TRUE       TRUE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [244]    chr10 99621632-99621961      * |      FALSE       TRUE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [1]         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [2]         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [3]         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [4]         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [5]         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ...       ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [240]         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [241]         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [242]         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [243]         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [244]         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqinfo: 25 sequences from GRCh37 genome</span>
<span class="r-in"><span><span class="fu">makeConsensus</span><span class="op">(</span><span class="va">grl</span>, p <span class="op">=</span> <span class="fl">2</span><span class="op">/</span><span class="fl">3</span>, var <span class="op">=</span> <span class="st">"score"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GRanges object with 164 ranges and 5 metadata columns:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         seqnames            ranges strand |         score SRR8315180 SRR8315181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt; | &lt;NumericList&gt;  &lt;logical&gt;  &lt;logical&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [1]    chr10 43048195-43048529      * |   251,531,391       TRUE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [2]    chr10 43521739-43522260      * |   223,548,645       TRUE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [3]    chr10 43540042-43540390      * |        58,206       TRUE      FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [4]    chr10 43606238-43606573      * |    92,192,302       TRUE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [5]    chr10 43851214-43851989      * |        87,148      FALSE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ...      ...               ...    ... .           ...        ...        ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [160]    chr10 99096784-99097428      * |   196,117,308       TRUE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [161]    chr10 99168353-99168649      * |    48,105,130       TRUE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [162]    chr10 99207868-99208156      * |        94,137      FALSE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [163]    chr10 99331363-99331730      * |   210,258,504       TRUE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [164]    chr10 99621632-99621961      * |         74,75      FALSE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         SRR8315182         n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;logical&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [1]       TRUE         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [2]       TRUE         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [3]       TRUE         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [4]       TRUE         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [5]       TRUE         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ...        ...       ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [160]       TRUE         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [161]       TRUE         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [162]       TRUE         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [163]       TRUE         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [164]       TRUE         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqinfo: 25 sequences from GRCh37 genome</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Using method = 'coverage' finds ranges based on the intersection</span></span></span>
<span class="r-in"><span><span class="fu">makeConsensus</span><span class="op">(</span><span class="va">grl</span>, p <span class="op">=</span> <span class="fl">2</span><span class="op">/</span><span class="fl">3</span>, var <span class="op">=</span> <span class="st">"score"</span>, method <span class="op">=</span> <span class="st">"coverage"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GRanges object with 164 ranges and 5 metadata columns:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         seqnames            ranges strand |         score SRR8315180 SRR8315181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt; | &lt;NumericList&gt;  &lt;logical&gt;  &lt;logical&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [1]    chr10 43048224-43048519      * |   251,531,391       TRUE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [2]    chr10 43521773-43522218      * |   223,548,645       TRUE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [3]    chr10 43540200-43540384      * |        58,206       TRUE      FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [4]    chr10 43606264-43606559      * |    92,192,302       TRUE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [5]    chr10 43851570-43851940      * |        87,148      FALSE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ...      ...               ...    ... .           ...        ...        ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [160]    chr10 99097038-99097398      * |   196,117,308       TRUE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [161]    chr10 99168367-99168608      * |    48,105,130       TRUE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [162]    chr10 99207908-99208139      * |        94,137      FALSE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [163]    chr10 99331412-99331687      * |   210,258,504       TRUE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [164]    chr10 99621674-99621944      * |         74,75      FALSE       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         SRR8315182         n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;logical&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [1]       TRUE         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [2]       TRUE         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [3]       TRUE         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [4]       TRUE         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     [5]       TRUE         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ...        ...       ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [160]       TRUE         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [161]       TRUE         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [162]       TRUE         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [163]       TRUE         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [164]       TRUE         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqinfo: 25 sequences from GRCh37 genome</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stephen Pederson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

