<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Map Genomic Ranges to genes using defined features — mapByFeature • extraChIPs</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Map Genomic Ranges to genes using defined features — mapByFeature" />
<meta property="og:description" content="Map Genomic Ranges to genes using defined regulatory features" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">extraChIPs</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/steveped/extraChIPs/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Map Genomic Ranges to genes using defined features</h1>
    <small class="dont-index">Source: <a href='https://github.com/steveped/extraChIPs/blob/master/R/mapByFeature.R'><code>R/mapByFeature.R</code></a></small>
    <div class="hidden name"><code>mapByFeature.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Map Genomic Ranges to genes using defined regulatory features</p>
    </div>

    <pre class="usage"><span class='fu'>mapByFeature</span><span class='op'>(</span>
  <span class='va'>gr</span>,
  <span class='va'>genes</span>,
  <span class='va'>prom</span>,
  <span class='va'>enh</span>,
  <span class='va'>gi</span>,
  cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"gene_id"</span>, <span class='st'>"gene_name"</span>, <span class='st'>"symbol"</span><span class='op'>)</span>,
  gr2prom <span class='op'>=</span> <span class='fl'>0</span>,
  gr2enh <span class='op'>=</span> <span class='fl'>0</span>,
  gr2gi <span class='op'>=</span> <span class='fl'>0</span>,
  gr2gene <span class='op'>=</span> <span class='fl'>1e+05</span>,
  prom2gene <span class='op'>=</span> <span class='fl'>0</span>,
  enh2gene <span class='op'>=</span> <span class='fl'>1e+05</span>,
  gi2gene <span class='op'>=</span> <span class='fl'>0</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gr</th>
      <td><p>GRanges object with query ranges to be mapped to genes</p></td>
    </tr>
    <tr>
      <th>genes</th>
      <td><p>GRanges object containing genes (or any other nominal feature)
to be assigned</p></td>
    </tr>
    <tr>
      <th>prom</th>
      <td><p>GRanges object defining promoters</p></td>
    </tr>
    <tr>
      <th>enh</th>
      <td><p>GRanges object defining Enhancers</p></td>
    </tr>
    <tr>
      <th>gi</th>
      <td><p>GInteractions object defining interactions. Mappings from
interactions to genes should be performed as a separate prior step.</p></td>
    </tr>
    <tr>
      <th>cols</th>
      <td><p>Column names to be assigned as mcols in the output. Columns
must be minimally present in <code>genes</code>. If all requested colunms are found in
any of prom, enh or gi, these pre-existing mappings will be preferentially
used. Any columns not found in utilised reference objects will be ignored.</p></td>
    </tr>
    <tr>
      <th>gr2prom</th>
      <td><p>The maximum permissible distance between a query range and
any ranges defined as promoters</p></td>
    </tr>
    <tr>
      <th>gr2enh</th>
      <td><p>The maximum permissible distance between a query range and
any ranges defined as enhancers</p></td>
    </tr>
    <tr>
      <th>gr2gi</th>
      <td><p>The maximum permissible distance between a query range and
any ranges defined as GInteraction anchors</p></td>
    </tr>
    <tr>
      <th>gr2gene</th>
      <td><p>The maximum permissible distance between a query range and
genes (for ranges not otherwise mapped)</p></td>
    </tr>
    <tr>
      <th>prom2gene</th>
      <td><p>The maximum permissible distance between a range provided
in <code>prom</code> and a gene</p></td>
    </tr>
    <tr>
      <th>enh2gene</th>
      <td><p>The maximum permissible distance between a range provided
in <code>enh</code> and a gene</p></td>
    </tr>
    <tr>
      <th>gi2gene</th>
      <td><p>The maximum permissible distance between a GInteractions
anchor (provided in <code>gi</code>) and a gene</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Passed to findOverlaps nad overlapsAny internally</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A GRanges object with added mcols as specified</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function is able to utilise feature-level information and long-range
interactions to enable better mapping of regions to genes. If provided, this
essentially maps from ranges to genes using the regulatory features as a
framework. The following sequential strategy is used:</p>
<ol>
<li><p>Ranges overlapping a promoter are assigned to that gene</p></li>
<li><p>Ranges overlapping an enhancer are assigned to all genes within
a specified distance</p></li>
<li><p>Ranges overlapping a long-range interaction are assigned to all genes
connected by the interaction</p></li>
<li><p>Ranges with no gene assignment from the previous steps are assigned
to <em>all genes</em> within a specified distance</p></li>
</ol>

<p>If information is missing for one of these steps, the algorithm will simply
proceed to the next step. If no promoter, enhancer or interaction data is
provided, all ranges will be simply mapped by step 4.</p>
<p>Distances between each set of features and the query range can be
individually specified by modifying the <code>gr2prom</code>, <code>gr2enh</code>, <code>gr2gi</code> or
<code>gr2gene</code> parameters. Distances between features and genes can also be set
using the parameters <code>prom2gene</code>, <code>enh2gene</code> and <code>gi2gene</code>.</p>
<p>Additionally, if previously defined mappings are included with any of the
<code>prom</code>, <code>enh</code> or <code>gi</code> objects, this will be used in preference to any
obtained from the <code>genes</code> object.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Define some genes</span>
<span class='va'>genes</span> <span class='op'>&lt;-</span> <span class='fu'>GRanges</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"chr1:2-10:*"</span>, <span class='st'>"chr1:25-30:-"</span>, <span class='st'>"chr1:31-40:+"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>genes</span><span class='op'>$</span><span class='va'>gene_id</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"gene"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>genes</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>## Add a promoter for each gene</span>
<span class='va'>prom</span> <span class='op'>&lt;-</span> <span class='fu'>promoters</span><span class='op'>(</span><span class='va'>genes</span>, upstream <span class='op'>=</span> <span class='fl'>1</span>, downstream <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='co'>## Some ranges to map</span>
<span class='va'>gr</span> <span class='op'>&lt;-</span> <span class='fu'>GRanges</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"chr1:"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>50</span>, by <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>mapByFeature</span><span class='op'>(</span><span class='va'>gr</span>, <span class='va'>genes</span><span class='op'>)</span>
</div><div class='output co'>#&gt; GRanges object with 6 ranges and 1 metadata column:
#&gt;       seqnames    ranges strand |           gene_id
#&gt;          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; |   &lt;CharacterList&gt;
#&gt;   [1]     chr1         0      * | gene1,gene2,gene3
#&gt;   [2]     chr1        10      * | gene1,gene2,gene3
#&gt;   [3]     chr1        20      * | gene1,gene2,gene3
#&gt;   [4]     chr1        30      * | gene1,gene2,gene3
#&gt;   [5]     chr1        40      * | gene1,gene2,gene3
#&gt;   [6]     chr1        50      * | gene1,gene2,gene3
#&gt;   -------
#&gt;   seqinfo: 1 sequence from an unspecified genome; no seqlengths</div><div class='input'><span class='fu'>mapByFeature</span><span class='op'>(</span><span class='va'>gr</span>, <span class='va'>genes</span>, <span class='va'>prom</span><span class='op'>)</span>
</div><div class='output co'>#&gt; GRanges object with 6 ranges and 1 metadata column:
#&gt;       seqnames    ranges strand |           gene_id
#&gt;          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; |   &lt;CharacterList&gt;
#&gt;   [1]     chr1         0      * |             gene1
#&gt;   [2]     chr1        10      * | gene1,gene2,gene3
#&gt;   [3]     chr1        20      * | gene1,gene2,gene3
#&gt;   [4]     chr1        30      * |       gene2,gene3
#&gt;   [5]     chr1        40      * | gene1,gene2,gene3
#&gt;   [6]     chr1        50      * | gene1,gene2,gene3
#&gt;   -------
#&gt;   seqinfo: 1 sequence from an unspecified genome; no seqlengths</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://github.com/steveped'>Stephen Pederson</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


